{"version":3,"sources":["../../src/Utils/ReferenceExtractor.js"],"names":[],"mappings":";;;;;;;;;;;AAMA,IAAM,qBAAqB,GAAG,CAC1B,WAAW,EACX,gBAAgB,EAChB,mBAAmB;AACnB,oBAAoB;CACvB,CAAA;;AAED,SAAS,gBAAgB,CAAE,KAAK,EAAE;AAC9B,WAAO,qBAAqB,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAA;CACtD;;;;;AAKD,IAAM,0BAA0B,GAAG,CAC/B,iBAAiB,EACjB,sBAAsB;CACzB,CAAA;;AAED,SAAS,oBAAoB,CAAE,KAAK,EAAE;AAClC,WAAO,0BAA0B,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAA;CAC3D;;qBAEc;;AAEX,sBAAkB,EAAA,4BAAC,MAAM,EAAE;AACvB,eAAO,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,MAAM;;AAEjC,kBAAA,CAAC;mBAAI,oBAAoB,CAAC,CAAC,CAAC;SAAA;;SAE3B,CACJ,CAAA;KACJ;AACD,iBAAa,EAAA,uBAAC,MAAM,EAAE,kBAAkB,EAAoB;YAAlB,SAAS,yDAAG,IAAI;;AACtD,YAAI,UAAU,GAAG,MAAM,CAAC,MAAM;;AAE1B,kBAAA,CAAC;mBAAI,gBAAgB,CAAC,CAAC,CAAC;SAAA;;SAE3B,CAAC;AACF,YAAI,kBAAkB,KAAK,IAAI,EAAE;AAC7B,sBAAU,GAAG,UAAU,CAAC,MAAM,CAAC,UAAA,CAAC;uBAAI,CAAC,CAAC,cAAc,EAAE;aAAA,CAAC,CAAC;SAC3D,MAAM,IAAI,kBAAkB,KAAK,KAAK,EAAE;AACrC,sBAAU,GAAG,UAAU,CAAC,MAAM,CAAC,UAAA,CAAC;uBAAI,CAAC,CAAC,CAAC,cAAc,EAAE;aAAA,CAAC,CAAC;SAC5D;AACD,YAAI,SAAS,KAAK,IAAI,EAAE;AACpB,sBAAU,GAAG,UAAU,CAAC,MAAM,CAAC,UAAA,CAAC;uBAAI,CAAC,CAAC,gBAAgB,EAAE,KAAK,SAAS;aAAA,CAAC,CAAA;SAC1E;AACD,eAAO,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;KACvC;AACD,6BAAyB,EAAA,mCAAC,MAAM,EAAE,kBAAkB,EAAE;AAClD,eAAO,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,kBAAkB,EAAE,KAAK,CAAC,CAAC;KAChE;AACD,0BAAsB,EAAA,gCAAC,MAAM,EAAE,kBAAkB,EAAE;AAC/C,eAAO,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,kBAAkB,EAAE,IAAI,CAAC,CAAC;KAC/D;AACD,eAAW,EAAA,qBAAC,UAAU,EAAE;AACpB,eAAO,UAAU,CAAC,MAAM,CAAC,UAAC,gBAAgB,EAAE,SAAS,EAAK;AACtD,4BAAgB,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC,GAAG,SAAS,CAAC;AAC/C,mBAAO,gBAAgB,CAAC;SAC3B,EAAE,EAAE,CAAC,CAAC;KACV;CACJ","file":"ReferenceExtractor.js","sourcesContent":["/*\n* A list of field types to instruct ng-admin to treat\n* as Reference fields. This fixes a problem where fields\n* that extended Reference would not be recognised as Reference\n* fields and so would not get their data correctly\n*/\nconst REFERENCE_FIELD_TYPES = [\n    'reference',\n    'reference_many',\n    'filteredReference', // custom\n    'addToListReference' // custom\n]\n\nfunction isReferenceField (field) {\n    return REFERENCE_FIELD_TYPES.includes(field.type())\n}\n\n/*\n* Same as above but for Reference Lists\n*/\nconst REFERENCE_LIST_FIELD_TYPES = [\n    'referenced_list',\n    'groupedReferenceList' // custom\n]\n\nfunction isReferenceListField (field) {\n    return REFERENCE_LIST_FIELD_TYPES.includes(field.type())\n}\n\nexport default {\n\n    getReferencedLists(fields) {\n        return this.indexByName(fields.filter(\n            /* custom */\n            f => isReferenceListField(f)\n            /* custom */\n            )\n        )\n    },\n    getReferences(fields, withRemoteComplete, optimized = null) {\n        let references = fields.filter(\n            /* custom */\n            f => isReferenceField(f)\n            /* custome */\n        );\n        if (withRemoteComplete === true) {\n            references = references.filter(r => r.remoteComplete());\n        } else if (withRemoteComplete === false) {\n            references = references.filter(r => !r.remoteComplete());\n        }\n        if (optimized !== null) {\n            references = references.filter(r => r.hasSingleApiCall() === optimized)\n        }\n        return this.indexByName(references);\n    },\n    getNonOptimizedReferences(fields, withRemoteComplete) {\n        return this.getReferences(fields, withRemoteComplete, false);\n    },\n    getOptimizedReferences(fields, withRemoteComplete) {\n        return this.getReferences(fields, withRemoteComplete, true);\n    },\n    indexByName(references) {\n        return references.reduce((referencesByName, reference) => {\n            referencesByName[reference.name()] = reference;\n            return referencesByName;\n        }, {});\n    }\n};\n\n\n"]}